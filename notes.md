Add test case for W [oosU4z] line 3.1
Improve performance [PSpSY9] line 4.1
